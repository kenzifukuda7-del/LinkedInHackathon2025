<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LinkedIn Research Made Simple</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest/dist/umd/lucide.js"></script>
    <style>
        body {
            background: linear-gradient(135deg, #f8fafc 0%, #dbeafe 100%);
        }
    </style>
</head>
<body>
    <div id="app">
        <!-- Landing Page -->
        <div id="landing-page" class="min-h-screen flex flex-col items-center justify-center px-4 py-12">
            <!-- Hero Section -->
            <div class="text-center mb-16 max-w-4xl">
                <div class="inline-flex items-center gap-2 bg-blue-100 text-blue-800 px-4 py-2 rounded-full text-sm font-medium mb-6">
                    <i data-lucide="star" class="w-4 h-4"></i>
                    Trusted by 10,000+ LinkedIn Sales Reps
                </div>
                <h1 class="text-5xl md:text-6xl lg:text-7xl font-bold mb-6">
                    <span class="text-blue-900">LinkedIn</span>
                    <span class="text-blue-600"> Research Made Simple</span>
                </h1>
                <p class="text-xl md:text-2xl text-gray-700 mb-8 max-w-3xl mx-auto">
                    Generate comprehensive company insights and personalized pitches for LinkedIn Talent Solutions, Learning, Marketing, and Sales Solutions.
                </p>
                <div class="flex flex-wrap justify-center gap-4 text-sm text-gray-600 mb-8">
                    <div class="flex items-center gap-2">
                        <i data-lucide="check" class="w-4 h-4 text-green-500"></i>
                        <span>AI-Powered Research</span>
                    </div>
                    <div class="flex items-center gap-2">
                        <i data-lucide="check" class="w-4 h-4 text-green-500"></i>
                        <span>Real-time Data</span>
                    </div>
                    <div class="flex items-center gap-2">
                        <i data-lucide="check" class="w-4 h-4 text-green-500"></i>
                        <span>LinkedIn Integration</span>
                    </div>
                </div>
            </div>

            <!-- Feature Cards -->
            <div class="grid grid-cols-1 md:grid-cols-3 gap-8 mb-16 max-w-6xl w-full">
                <div class="bg-white rounded-2xl p-8 shadow-lg hover:shadow-xl transition-shadow duration-300">
                    <div class="w-16 h-16 bg-blue-600 rounded-full flex items-center justify-center mb-6 mx-auto">
                        <i data-lucide="bar-chart-3" class="w-8 h-8 text-white"></i>
                    </div>
                    <h3 class="text-xl font-bold text-gray-800 mb-4 text-center">
                        Comprehensive Research
                    </h3>
                    <p class="text-gray-600 text-center leading-relaxed">
                        Company history, financials, news, and industry analysis in one place
                    </p>
                </div>
                
                <div class="bg-white rounded-2xl p-8 shadow-lg hover:shadow-xl transition-shadow duration-300">
                    <div class="w-16 h-16 bg-blue-600 rounded-full flex items-center justify-center mb-6 mx-auto">
                        <i data-lucide="users" class="w-8 h-8 text-white"></i>
                    </div>
                    <h3 class="text-xl font-bold text-gray-800 mb-4 text-center">
                        Key Stakeholders
                    </h3>
                    <p class="text-gray-600 text-center leading-relaxed">
                        Identify decision makers and champions within target organizations
                    </p>
                </div>
                
                <div class="bg-white rounded-2xl p-8 shadow-lg hover:shadow-xl transition-shadow duration-300">
                    <div class="w-16 h-16 bg-blue-600 rounded-full flex items-center justify-center mb-6 mx-auto">
                        <i data-lucide="zap" class="w-8 h-8 text-white"></i>
                    </div>
                    <h3 class="text-xl font-bold text-gray-800 mb-4 text-center">
                        AI-Powered Emails
                    </h3>
                    <p class="text-gray-600 text-center leading-relaxed">
                        Generate personalized outreach emails tailored to LinkedIn products
                    </p>
                </div>
            </div>

            <!-- CTA Button -->
            <button onclick="showWorkflow()" class="bg-blue-600 hover:bg-blue-700 text-white font-semibold py-4 px-8 rounded-xl text-lg transition-colors duration-300 flex items-center gap-2 mb-16">
                Start Research
                <i data-lucide="arrow-right" class="w-5 h-5"></i>
            </button>

            <!-- Footer -->
            <div class="text-center">
                <p class="text-gray-600 font-semibold mb-6">TRUSTED BY LINKEDIN SALES TEAMS</p>
                <div class="flex flex-wrap justify-center gap-8 text-gray-700">
                    <div class="flex items-center gap-2">
                        <div class="w-2 h-2 bg-blue-600 rounded-full"></div>
                        <span>Talent Solutions</span>
                    </div>
                    <div class="flex items-center gap-2">
                        <div class="w-2 h-2 bg-blue-600 rounded-full"></div>
                        <span>Marketing Solutions</span>
                    </div>
                    <div class="flex items-center gap-2">
                        <div class="w-2 h-2 bg-blue-600 rounded-full"></div>
                        <span>Sales Solutions</span>
                    </div>
                    <div class="flex items-center gap-2">
                        <div class="w-2 h-2 bg-blue-600 rounded-full"></div>
                        <span>Learning Solutions</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- Workflow Screen -->
        <div id="workflow-screen" class="min-h-screen bg-gradient-to-br from-blue-50 to-blue-100 p-4 hidden">
            <div class="max-w-6xl mx-auto">
                <!-- Header -->
                <div class="flex items-center gap-4 mb-8">
                    <button onclick="showLanding()" class="flex items-center gap-2 text-blue-600 hover:text-blue-700 font-medium">
                        <i data-lucide="arrow-left" class="w-5 h-5"></i>
                        Back to Home
                    </button>
                    <h1 class="text-3xl font-bold text-gray-800">Sales Research Workflow</h1>
                </div>

                <!-- Inputs Section -->
                <div class="bg-white rounded-2xl p-8 shadow-lg mb-8">
                    <h2 class="text-2xl font-bold text-gray-800 mb-6">Company Information</h2>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">
                                Company Name
                            </label>
                            <input type="text" id="companyName" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" placeholder="Enter company name">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">
                                Company Website
                            </label>
                            <input type="url" id="companyWebsite" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" placeholder="https://www.company.com">
                        </div>
                    </div>
                    
                    <div class="mt-6">
                        <label class="block text-sm font-medium text-gray-700 mb-2">
                            LinkedIn Product Focus
                        </label>
                        <select id="selectedProduct" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" onchange="updateProductDescription()">
                            <option value="LTS">LinkedIn Talent Solutions</option>
                            <option value="LLS">LinkedIn Learning Solutions</option>
                            <option value="LMS">LinkedIn Marketing Solutions</option>
                            <option value="LSS">LinkedIn Sales Solutions</option>
                        </select>
                        <div id="productDescription" class="mt-3 p-4 bg-blue-50 rounded-lg">
                            <p class="text-sm text-blue-800">
                                <strong>LinkedIn Talent Solutions:</strong> Find, attract, and hire the right talent with LinkedIn Recruiter, Talent Insights, and job posting solutions.
                            </p>
                        </div>
                    </div>
                </div>

                <!-- Research Options -->
                <div class="bg-white rounded-2xl p-8 shadow-lg mb-8">
                    <h2 class="text-2xl font-bold text-gray-800 mb-6">Research Options</h2>
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                        <label class="flex items-center gap-3 p-4 border border-gray-200 rounded-lg hover:bg-gray-50 cursor-pointer">
                            <input type="checkbox" class="w-5 h-5 text-blue-600 border-gray-300 rounded focus:ring-blue-500" value="companyHistory">
                            <span class="text-sm font-medium text-gray-700">Company History</span>
                        </label>
                        <label class="flex items-center gap-3 p-4 border border-gray-200 rounded-lg hover:bg-gray-50 cursor-pointer">
                            <input type="checkbox" class="w-5 h-5 text-blue-600 border-gray-300 rounded focus:ring-blue-500" value="existingProducts">
                            <span class="text-sm font-medium text-gray-700">Existing Products</span>
                        </label>
                        <label class="flex items-center gap-3 p-4 border border-gray-200 rounded-lg hover:bg-gray-50 cursor-pointer">
                            <input type="checkbox" class="w-5 h-5 text-blue-600 border-gray-300 rounded focus:ring-blue-500" value="financialInfo">
                            <span class="text-sm font-medium text-gray-700">Financial Information</span>
                        </label>
                        <label class="flex items-center gap-3 p-4 border border-gray-200 rounded-lg hover:bg-gray-50 cursor-pointer">
                            <input type="checkbox" class="w-5 h-5 text-blue-600 border-gray-300 rounded focus:ring-blue-500" value="newsArticles">
                            <span class="text-sm font-medium text-gray-700">News Articles</span>
                        </label>
                        <label class="flex items-center gap-3 p-4 border border-gray-200 rounded-lg hover:bg-gray-50 cursor-pointer">
                            <input type="checkbox" class="w-5 h-5 text-blue-600 border-gray-300 rounded focus:ring-blue-500" value="industryDeepDive">
                            <span class="text-sm font-medium text-gray-700">Industry Deep Dive</span>
                        </label>
                        <label class="flex items-center gap-3 p-4 border border-gray-200 rounded-lg hover:bg-gray-50 cursor-pointer">
                            <input type="checkbox" class="w-5 h-5 text-blue-600 border-gray-300 rounded focus:ring-blue-500" value="competitorsTrends">
                            <span class="text-sm font-medium text-gray-700">Competitors and Trends</span>
                        </label>
                        <label class="flex items-center gap-3 p-4 border border-gray-200 rounded-lg hover:bg-gray-50 cursor-pointer">
                            <input type="checkbox" class="w-5 h-5 text-blue-600 border-gray-300 rounded focus:ring-blue-500" value="keyStakeholders">
                            <span class="text-sm font-medium text-gray-700">Key Stakeholders</span>
                        </label>
                        <label class="flex items-center gap-3 p-4 border border-gray-200 rounded-lg hover:bg-gray-50 cursor-pointer">
                            <input type="checkbox" class="w-5 h-5 text-blue-600 border-gray-300 rounded focus:ring-blue-500" value="draftEmail">
                            <span class="text-sm font-medium text-gray-700">Draft Email</span>
                        </label>
                        <label class="flex items-center gap-3 p-4 border border-gray-200 rounded-lg hover:bg-gray-50 cursor-pointer">
                            <input type="checkbox" class="w-5 h-5 text-blue-600 border-gray-300 rounded focus:ring-blue-500" value="exportMarkdown">
                            <span class="text-sm font-medium text-gray-700">Export Markdown</span>
                        </label>
                    </div>
                </div>

                <!-- Progress Indicator -->
                <div id="progress-section" class="bg-white rounded-2xl p-8 shadow-lg mb-8 hidden">
                    <div class="flex items-center justify-between mb-4">
                        <h3 class="text-lg font-semibold text-gray-800">Generating Research...</h3>
                        <span id="progress-percentage" class="text-sm text-gray-600">0%</span>
                    </div>
                    <div class="w-full bg-gray-200 rounded-full h-2">
                        <div id="progress-bar" class="bg-blue-600 h-2 rounded-full transition-all duration-300" style="width: 0%"></div>
                    </div>
                    <div id="progress-steps" class="mt-4 space-y-2">
                        <div class="flex items-center gap-3 text-sm">
                            <i data-lucide="loader" class="w-4 h-4 animate-spin text-blue-600"></i>
                            <span class="text-gray-600">Gathering company data...</span>
                        </div>
                    </div>
                </div>

                <!-- Generate Button -->
                <div class="text-center mb-8">
                    <button onclick="generateResults()" id="generate-btn" class="bg-blue-600 hover:bg-blue-700 text-white font-semibold py-4 px-8 rounded-xl text-lg transition-colors duration-300 flex items-center gap-2 mx-auto">
                        <i data-lucide="search" class="w-5 h-5"></i>
                        Generate Research Results
                    </button>
                </div>

                <!-- Results Section -->
                <div id="results-section" class="bg-white rounded-2xl p-8 shadow-lg hidden">
                    <div class="flex items-center justify-between mb-6">
                        <h2 class="text-2xl font-bold text-gray-800">Research Results</h2>
                        <div class="flex gap-2">
                            <button onclick="toggleAllResults()" id="toggle-all-btn" class="flex items-center gap-2 px-4 py-2 bg-gray-100 hover:bg-gray-200 text-gray-700 rounded-lg text-sm transition-colors">
                                <i data-lucide="chevron-up" class="w-4 h-4"></i>
                                Collapse All
                            </button>
                            <button onclick="exportResults('markdown')" class="flex items-center gap-2 px-4 py-2 bg-gray-100 hover:bg-gray-200 text-gray-700 rounded-lg text-sm transition-colors">
                                <i data-lucide="file-text" class="w-4 h-4"></i>
                                Export Markdown
                            </button>
                        </div>
                    </div>
                    <div id="results-content" class="space-y-4">
                        <!-- Results will be populated here -->
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Initialize Lucide icons
        lucide.createIcons();

        const productDescriptions = {
            'LTS': '<strong>LinkedIn Talent Solutions:</strong> Find, attract, and hire the right talent with LinkedIn Recruiter, Talent Insights, and job posting solutions.',
            'LLS': '<strong>LinkedIn Learning Solutions:</strong> Develop your workforce with personalized learning paths, skill assessments, and expert-led courses.',
            'LMS': '<strong>LinkedIn Marketing Solutions:</strong> Reach and engage your target audience with sponsored content, lead generation, and dynamic ads.',
            'LSS': '<strong>LinkedIn Sales Solutions:</strong> Identify prospects, build relationships, and close deals with Sales Navigator and CRM integrations.'
        };

        function showWorkflow() {
            document.getElementById('landing-page').classList.add('hidden');
            document.getElementById('workflow-screen').classList.remove('hidden');
            lucide.createIcons();
        }

        function showLanding() {
            document.getElementById('workflow-screen').classList.add('hidden');
            document.getElementById('landing-page').classList.remove('hidden');
            lucide.createIcons();
        }

        function updateProductDescription() {
            const selectedProduct = document.getElementById('selectedProduct').value;
            document.getElementById('productDescription').innerHTML = `<p class="text-sm text-blue-800">${productDescriptions[selectedProduct]}</p>`;
        }

        async function generateResults() {
            const companyName = document.getElementById('companyName').value;
            const companyWebsite = document.getElementById('companyWebsite').value;
            const selectedProduct = document.getElementById('selectedProduct').value;
            const checked = Array.from(document.querySelectorAll('input[type="checkbox"]:checked')).map(cb => cb.value);

            if (!companyName || checked.length === 0) {
                alert('Please enter a company name and select at least one research option.');
                return;
            }

            // Show progress, disable button
            document.getElementById('progress-section').classList.remove('hidden');
            document.getElementById('results-section').classList.add('hidden');
            const btn = document.getElementById('generate-btn');
            btn.disabled = true;
            btn.innerHTML = '<i data-lucide="loader" class="w-5 h-5 animate-spin"></i> Generating...';
            lucide.createIcons();

            // Build researchOptions flags
            const researchOptions = {};
            checked.forEach(key => researchOptions[key] = true);

            try {
                const resp = await fetch('http://localhost:3000/api/research', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ companyName, companyWebsite, selectedProduct, researchOptions })
                });
                if (!resp.ok) throw new Error('API error');
                const data = await resp.json();
                renderResults(companyName, selectedProduct, researchOptions, data);
            } catch (e) {
                alert('Failed to generate research. Please ensure the Next.js app is running on http://localhost:3000');
            } finally {
                document.getElementById('progress-section').classList.add('hidden');
                btn.disabled = false;
                btn.innerHTML = '<i data-lucide="search" class="w-5 h-5"></i> Generate Research Results';
                lucide.createIcons();
            }
        }

        function renderResults(companyName, selectedProduct, researchOptions, payload) {
            document.getElementById('results-section').classList.remove('hidden');
            const resultsContent = document.getElementById('results-content');
            resultsContent.innerHTML = '';

            // Success banner
            const count = Object.keys(researchOptions).length;
            resultsContent.innerHTML += `
                <div class="bg-green-50 border border-green-200 rounded-lg p-4 mb-6">
                    <div class="flex items-center gap-2">
                        <i data-lucide="check-circle" class="w-5 h-5 text-green-600"></i>
                        <span class="text-green-800 font-medium">Research completed successfully!</span>
                    </div>
                    <p class="text-green-700 text-sm mt-1">Generated ${count} research categories for ${companyName}</p>
                </div>
            `;

            const results = payload.results || {};

            // Helper to add a collapsible card
            function addCard(key, title, html) {
                if (!researchOptions[key]) return;
                const id = `content-${key}`;
                resultsContent.innerHTML += `
                    <div class="border border-gray-200 rounded-lg">
                        <button onclick="toggleResult('${key}')" class="w-full flex items-center justify-between p-4 text-left hover:bg-gray-50">
                            <span class="font-medium text-gray-800">${title}</span>
                            <i data-lucide="chevron-up" class="w-5 h-5 text-gray-500" id="icon-${key}"></i>
                        </button>
                        <div id="${id}" class="px-4 pb-4 border-t border-gray-200">
                            <div class="pt-4">${html}</div>
                        </div>
                    </div>
                `;
            }

            // Build sections
            if (researchOptions.companyHistory && results.companyHistory) {
                addCard('companyHistory', 'Company History', `<div class="whitespace-pre-wrap text-sm">${escapeHtml(results.companyHistory.executiveBrief || '')}</div>`);
            }
            if (researchOptions.existingProducts && results.existingProducts) {
                addCard('existingProducts', 'Existing Products / Offerings (Signals)', `<div class="whitespace-pre-wrap text-sm">${escapeHtml(results.existingProducts.adsOpportunities || '')}</div>`);
            }
            if (researchOptions.financialInfo && results.financialInfo) {
                const items = results.financialInfo.earnings || [];
                const html = items.map(d => `- <a href="${d.url}" class="text-blue-600 hover:underline" target="_blank">${escapeHtml(d.title)}</a>${d.date ? ` <span class='text-gray-500 text-xs'>(${escapeHtml(d.date)})</span>` : ''}`).join('<br>');
                addCard('financialInfo', 'Financial Information (Earnings/IR)', `<div class="text-sm">${html || 'No items found'}</div>`);
            }
            if (researchOptions.newsArticles && results.newsArticles) {
                const items = results.newsArticles.press || [];
                const html = items.map(d => `- <a href="${d.url}" class="text-blue-600 hover:underline" target="_blank">${escapeHtml(d.title)}</a>${d.date ? ` <span class='text-gray-500 text-xs'>(${escapeHtml(d.date)})</span>` : ''}`).join('<br>');
                addCard('newsArticles', 'News Articles & Press', `<div class="text-sm">${html || 'No items found'}</div>`);
            }
            if (researchOptions.industryDeepDive && results.industryDeepDive) {
                const items = results.industryDeepDive.industry || [];
                const html = items.map(d => `- <a href="${d.url}" class="text-blue-600 hover:underline" target="_blank">${escapeHtml(d.title)}</a>${d.date ? ` <span class='text-gray-500 text-xs'>(${escapeHtml(d.date)})</span>` : ''}`).join('<br>');
                addCard('industryDeepDive', 'Industry Deep Dive', `<div class="text-sm">${html || 'No items found'}</div>`);
            }
            if (researchOptions.competitorsTrends && results.competitorsTrends) {
                const items = results.competitorsTrends.competitors || [];
                const html = items.map(c => `- ${escapeHtml(c)}`).join('<br>');
                addCard('competitorsTrends', 'Competitors & Market Trends', `<div class="text-sm">${html || 'No items found'}</div>`);
            }
            if (researchOptions.draftEmail && results.draftEmail) {
                const { subject, body } = results.draftEmail;
                addCard('draftEmail', 'Draft Email', `
                    <div class="space-y-3">
                        <div><strong>Subject:</strong> ${escapeHtml(subject || '')}</div>
                        <pre class="mt-2 p-3 bg-gray-50 rounded text-sm whitespace-pre-wrap">${escapeHtml(body || '')}</pre>
                    </div>
                `);
            }
            if (researchOptions.exportMarkdown && results.exportMarkdown) {
                addCard('exportMarkdown', 'Export (Markdown)', `
                    <textarea class="w-full p-3 border rounded text-sm" rows="10">${escapeHtml(results.exportMarkdown)}</textarea>
                `);
            }

            document.getElementById('results-section').scrollIntoView({ behavior: 'smooth' });
            lucide.createIcons();
        }

        function toggleResult(option) {
            const content = document.getElementById(`content-${option}`) || document.getElementById(`content-${option}`);
            const icon = document.getElementById(`icon-${option}`);
            if (!content || !icon) return;
            if (content.classList.contains('hidden')) {
                content.classList.remove('hidden');
                icon.setAttribute('data-lucide', 'chevron-up');
            } else {
                content.classList.add('hidden');
                icon.setAttribute('data-lucide', 'chevron-down');
            }
            lucide.createIcons();
        }

        function toggleAllResults() {
            const toggleBtn = document.getElementById('toggle-all-btn');
            const toggleIcon = toggleBtn.querySelector('i');
            const allContents = document.querySelectorAll('[id^="content-"]');
            const allIcons = document.querySelectorAll('[id^="icon-"]');
            const hasVisibleContent = Array.from(allContents).some(content => !content.classList.contains('hidden'));
            if (hasVisibleContent) {
                allContents.forEach(content => content.classList.add('hidden'));
                allIcons.forEach(icon => icon.setAttribute('data-lucide', 'chevron-down'));
                toggleIcon.setAttribute('data-lucide', 'chevron-down');
                toggleBtn.innerHTML = '<i data-lucide="chevron-down" class="w-4 h-4"></i> Expand All';
            } else {
                allContents.forEach(content => content.classList.remove('hidden'));
                allIcons.forEach(icon => icon.setAttribute('data-lucide', 'chevron-up'));
                toggleIcon.setAttribute('data-lucide', 'chevron-up');
                toggleBtn.innerHTML = '<i data-lucide="chevron-up" class="w-4 h-4"></i> Collapse All';
            }
            lucide.createIcons();
        }

        function exportResults(format) {
            const textarea = document.querySelector('#content-exportMarkdown textarea');
            if (format === 'markdown' && textarea) {
                const blob = new Blob([textarea.value], { type: 'text/markdown;charset=utf-8' });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = 'sales-prep.md';
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                URL.revokeObjectURL(url);
            } else {
                alert('Enable "Export Markdown" option to generate downloadable content.');
            }
        }

        function escapeHtml(s) {
            return (s || '').replace(/[&<>"']/g, c => ({ '&': '&amp;', '<': '&lt;', '>': '&gt;', '"': '&quot;', "'": '&#39;' }[c]));
        }
    </script>
</body>
</html>
